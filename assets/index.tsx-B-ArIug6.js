import{j as e,c as t,r as o}from"./index-D_Ii-jDN.js";const n=t=>e.jsx("img",{src:`https://cdn.simpleicons.org/${t}/white`,alt:t,className:"w-8 h-8 object-contain opacity-70 group-hover:opacity-100 transition-opacity duration-300",loading:"lazy"}),r=({label:t,icon:o,subtext:n,url:r})=>e.jsxs("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"\n      group flex items-center gap-3 p-3 rounded-xl \n      bg-[#252833]/40 border border-transparent \n      hover:bg-white/10 hover:border-white/30\n      transition-all duration-200\n    ",children:[e.jsx("div",{className:"flex-shrink-0 flex items-center justify-center",children:o}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-sm font-medium text-[#E2E2E2] group-hover:text-white transition-colors",children:t}),e.jsx("span",{className:"text-[10px] text-[#888] group-hover:text-[#CCC] transition-colors",children:n})]}),e.jsx("span",{className:"ml-auto text-[#666] opacity-0 -translate-x-2 group-hover:opacity-100 group-hover:translate-x-0 transition-all duration-300",children:e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("line",{x1:"7",y1:"17",x2:"17",y2:"7"}),e.jsx("polyline",{points:"7 7 17 7 17 17"})]})})]}),l=()=>e.jsx("div",{className:"w-full pt-3 mt-1 text-center border-t border-[#252833]",children:e.jsxs("p",{className:"text-[11px] text-[#555]",children:["Powered by"," ",e.jsx("a",{href:"https://github.com/010101-sans/moctale-plus",target:"_blank",rel:"noreferrer",className:"hover:text-[#888] underline decoration-dotted",children:"Moctale Plus"})," ","by"," ",e.jsx("a",{href:"https://github.com/010101-sans",target:"_blank",rel:"noreferrer",className:"hover:text-[#888] underline decoration-dotted",children:"010101-sans"})]})}),a=({title:t,year:o,type:a,isAnime:i})=>{const s=encodeURIComponent(`${t} ${o}`),c="Movie"===a?"Movie":"Series",d=[{label:"YouTube Reviews",icon:n("youtube"),url:`https://www.youtube.com/results?search_query=${s.replace(`%20${o}`,"")}${i?"+anime":""}+${c}+review`},{label:"YouTube Podcasts",icon:n("youtube"),url:`https://www.youtube.com/results?search_query=${s.replace(`%20${o}`,"")}${i?"+anime":""}+podcast+discussion`},{label:"Hidden Details",icon:n("youtube"),url:`https://www.youtube.com/results?search_query=${s.replace(`%20${o}`,"")}${i?"+anime":""}+detailed+analysis+and+breakdown`},{label:"Twitter / X",icon:n("x"),url:`https://twitter.com/search?q=${s.replace(`%20${o}`,"")}${i?"+anime":""}+review+sand+discussion&f=top`},{label:"Reddit",icon:n("reddit"),url:`https://www.reddit.com/search/?q=${s.replace(`%20${o}`,"")}${i?"+anime":""}+reviews+and+discussion`}];return e.jsxs("div",{className:"flex flex-col items-start px-5 py-5 gap-4 w-full md:bg-[#1B1B1B] md:border md:border-[#252833] rounded-2xl",children:[e.jsx("h2",{className:"text-[20px] font-medium text-[#E2E2E2] w-full border-b border-[#252833] pb-3 tracking-[0.1px]",children:"Reviews & Discussions"}),e.jsx("div",{className:"flex flex-col w-full gap-2",children:d.map((o,n)=>e.jsx(r,{...o,subtext:`Search ${t}`},n))}),e.jsx(l,{})]})},i=({title:t,year:o,isAnime:a})=>{const i=encodeURIComponent(`${t} ${o}`),s=[...a?[{label:"MyAnimeList",icon:n("myanimelist"),url:`https://myanimelist.net/search/all?q=${i.replace(`%20${o}`,"")}`},{label:"AniList",icon:n("anilist"),url:`https://anilist.co/search/anime?search=${i.replace(`%20${o}`,"")}`},{label:"Kitsu",icon:n("kitsu"),url:`https://kitsu.io/anime?text=${i.replace(`%20${o}`,"")}`}]:[],{label:"IMDb",icon:n("imdb"),url:`https://www.imdb.com/find/?q=${i.replace(`%20${o}`,"")}`},{label:"TMDB",icon:n("themoviedatabase"),url:`https://www.themoviedb.org/search?query=${i.replace(`%20${o}`,"")}`},{label:"Letterboxd",icon:n("letterboxd"),url:`https://letterboxd.com/search/${i.replace(`%20${o}`,"")}/`}];return e.jsxs("div",{className:"flex flex-col items-start px-5 py-5 gap-4 w-full md:bg-[#1B1B1B] md:border md:border-[#252833] rounded-2xl",children:[e.jsx("h2",{className:"text-[20px] font-medium text-[#E2E2E2] w-full border-b border-[#252833] pb-3 tracking-[0.1px]",children:"More Platforms"}),e.jsx("div",{className:"flex flex-col w-full gap-2",children:s.map((t,o)=>e.jsx(r,{...t,subtext:`View on ${t.label}`},o))}),e.jsx(l,{})]})},s={Cosplay:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"opacity-70 group-hover:opacity-100 transition-opacity duration-300",children:[e.jsx("path",{d:"M2 22c0-3.87 3.13-7 7-7h6c3.87 0 7 3.13 7 7"}),e.jsx("path",{d:"M12 2a5 5 0 0 0-5 5v2a5 5 0 0 0 10 0V7a5 5 0 0 0-5-5z"})]}),FanFic:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"opacity-70 group-hover:opacity-100 transition-opacity duration-300",children:e.jsx("path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"})}),Merch:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"opacity-70 group-hover:opacity-100 transition-opacity duration-300",children:[e.jsx("path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"}),e.jsx("path",{d:"M3 6h18"}),e.jsx("path",{d:"M16 10a4 4 0 0 1-8 0"})]})},c=({title:t,year:o,type:a,isAnime:i})=>{const c=encodeURIComponent(`${t}`),d=[{label:"Spotify",icon:n("spotify"),url:`https://open.spotify.com/search/${c}`},{label:"YouTube Music",icon:n("youtubemusic"),url:`https://music.youtube.com/search?q=${c}`},{label:"Behind The Scenes",icon:n("youtube"),url:"https://www.youtube.com/results?search_query={query}+Behind+The+Scenes"},{label:"Fan Edits",icon:n("youtube"),url:`https://www.youtube.com/results?search_query=${c}+Fan+Edits`},{label:"Pinterest",icon:n("pinterest"),url:`https://www.pinterest.com/search/pins/?q=${c}`},{label:"ArtStation",icon:n("artstation"),url:`https://www.artstation.com/search?sort_by=relevance&query=${c}`},{label:"Merchandise",icon:s.Merch,url:`https://www.google.com/search?q=${c}+official+merchandise`},{label:"Cosplay",icon:s.Cosplay,url:`https://www.google.com/search?tbm=isch&q=${c}+cosplay`},{label:"Fan Fiction",icon:s.FanFic,url:`https://www.google.com/search?q=${c}+fan+fiction`}];return e.jsxs("div",{className:"flex flex-col items-start px-5 py-5 gap-4 w-full md:bg-[#1B1B1B] md:border md:border-[#252833] rounded-2xl",children:[e.jsx("div",{className:"w-full flex items-center justify-between border-b border-[#252833] pb-3",children:e.jsx("h2",{className:"text-[20px] font-medium text-[#E2E2E2] tracking-[0.1px]",children:"Creative Corner"})}),e.jsx("div",{className:"grid grid-cols-1 w-full gap-2",children:d.map((o,n)=>e.jsx(r,{...o,subtext:`Search ${t}`},n))}),e.jsx("div",{className:"w-full pt-2",children:e.jsx(l,{})})]})},d=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-[#888] group-hover:text-white transition-colors",children:[e.jsx("circle",{cx:"11",cy:"11",r:"8"}),e.jsx("path",{d:"m21 21-4.3-4.3"})]}),u=({label:t,url:o,colorClass:n})=>e.jsxs("a",{href:o,target:"_blank",rel:"noopener noreferrer",className:`\n      flex items-center gap-3 px-3 py-2.5 rounded-xl\n      bg-[#252833]/40 border border-[#333] \n      hover:bg-[#303440] hover:border-[#555] hover:text-white\n      transition-all duration-200 group\n      text-xs font-medium text-[#C6C6C6]\n      h-full\n      ${n||""}\n    `,children:[e.jsx("div",{className:"flex-shrink-0 opacity-70 group-hover:opacity-100 transition-opacity",children:e.jsx(d,{})}),e.jsx("span",{className:"truncate line-clamp-2 break-words whitespace-normal leading-tight text-left",children:t})]}),m=({title:t})=>{const o=encodeURIComponent(t);return e.jsxs("div",{className:"flex flex-col items-start px-5 py-5 gap-4 w-full md:bg-[#1B1B1B] md:border md:border-[#252833] rounded-2xl transition-all hover:border-[#3a3f50]",children:[e.jsx("h2",{className:"text-[20px] font-medium text-[#E2E2E2] w-full border-b border-[#252833] pb-3 tracking-[0.1px] flex justify-between items-center",children:"Box Office"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 w-full",children:[e.jsx(u,{label:"Google Box Office",url:`https://www.google.com/search?q=${o}+box+office+report`}),e.jsx(u,{label:"Box Office Mojo",url:`https://www.boxofficemojo.com/search/?q=${o}`,colorClass:"hover:border-yellow-500/40"}),e.jsx(u,{label:"Sacnilk Verdict",url:`https://www.google.com/search?q=${o}+box+office+collection+site:sacnilk.com`,colorClass:"hover:border-red-500/40"}),e.jsx(u,{label:"Bollywood Hungama",url:`https://www.google.com/search?q=${o}+box+office+site:bollywoodhungama.com`}),e.jsx(u,{label:"The Numbers",url:`https://www.the-numbers.com/search?search_term=${o}`}),e.jsx(u,{label:"Wikipedia Budget",url:`https://en.wikipedia.org/wiki/Special:Search?search=${o}+film+box+office`})]}),e.jsx(l,{})]})},p=({mediaInfo:t,settings:o})=>e.jsxs("div",{className:"flex flex-col gap-6 w-full mt-6 transition-all duration-300 ease-in-out",children:[o.enableBoxOffice&&"Movie"===t.type&&e.jsx(m,{title:t.title,year:t.year}),o.enableDiscussions&&e.jsx(a,{...t}),o.enablePlatforms&&e.jsx(i,{...t}),o.enableCreative&&e.jsx(c,{...t})]}),h="moctale-linkified",x=/\b(?:https?:\/\/)?(?:www\.)?(?:[a-zA-Z0-9-]+\.)+[a-zA-Z]{2,}(?:\/[^\s"'<>]*)?\b/g,f=()=>{const e=document.body,t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode(e){const t=e.parentElement;if(!t||t.closest("a, button, input, textarea, code, pre"))return NodeFilter.FILTER_REJECT;if(!e.nodeValue?.trim())return NodeFilter.FILTER_REJECT;const o=e.nodeValue||"";return!o.includes(".")||o.length<4?NodeFilter.FILTER_SKIP:/(?:https?:\/\/|www\.|[\w-]+\.[\w]{2,})/.test(o)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}}),o=[];let n;for(;n=t.nextNode();)o.push(n);o.forEach(e=>{const t=e.nodeValue;if(x.lastIndex=0,!x.test(t))return;x.lastIndex=0;const o=document.createDocumentFragment();let n=0,r=!1;t.replace(x,(e,l)=>{r=!0,o.append(t.slice(n,l));const a=(e=>{const t=e.startsWith("http")?e:`https://${e}`;try{return new URL(t).href}catch{return null}})(e);if(a){const t=document.createElement("a");t.href=a,t.textContent=e,t.target="_blank",t.rel="noopener noreferrer",t.className=`${h} text-blue-400 hover:underline cursor-pointer z-10 relative`,t.addEventListener("click",e=>e.stopPropagation()),o.append(t)}else o.append(e);return n=l+e.length,e}),r&&(o.append(t.slice(n)),e.parentNode?.replaceChild(o,e))})},g=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"7 10 12 15 17 10"}),e.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),w=()=>e.jsxs("button",{type:"button",onClick:()=>{const e=(()=>{const e=[],t=document.querySelectorAll('a[href^="/content/"].group');return 0===t.length?(alert("[Moctale+] No content items found. Please scroll down to ensure items are loaded."),[]):(t.forEach(t=>{let o=t.getAttribute("aria-label");if(!o){const e=t.querySelector("h3");o=e?.textContent?.trim()||"Unknown Title"}const n=t.querySelector("p"),r=n?.textContent?.trim()||"";let l="Unknown",a="N/A";const i=r.match(/^(.*?)\s+â€¢\s+(\d{4})$/);if(i)l=i[1].trim(),a=i[2];else{const e=r.match(/\d{4}/);e&&(a=e[0]),r.toLowerCase().includes("movie")?l="Movie":(r.toLowerCase().includes("show")||r.toLowerCase().includes("tv")||r.toLowerCase().includes("season"))&&(l="Show")}e.push({title:o,year:a,type:l})}),e)})();if(e&&e.length>0){const t=document.querySelector("h1.text-lg.lg\\:text-2xl");((e,t)=>{const o=[["Title","Year","Type"].join(","),...e.map(e=>`"${e.title.replace(/"/g,'""')}",${e.year},${e.type}`)].join("\n"),n=new Blob([o],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(n),l=document.createElement("a");l.href=r;const a=t.replace(/[<>:"/\\|?*\x00-\x1F]/g,"").trim();l.setAttribute("download",`${a}.csv`),document.body.appendChild(l),l.click(),document.body.removeChild(l)})(e,t?.textContent?.trim()||"Moctale_Collection")}},className:"\n        h-10 px-3 ml-2 rounded-md\n        inline-flex items-center justify-center gap-2\n        transition-colors duration-200\n        focus:outline-none focus:ring-1\n        bg-[#1A1A1A] hover:bg-[#252525] focus:ring-[#404040]\n        cursor-pointer \n      ",title:"Tip: Scroll to bottom of the collection first.",children:[e.jsx(g,{}),e.jsxs("div",{className:"flex flex-col items-start justify-center gap-1",children:[e.jsx("span",{className:"text-xs font-medium text-white leading-none",children:"Export Collection"}),e.jsxs("span",{className:"text-[9px] text-white/60 leading-none whitespace-nowrap",children:["Powered by"," ",e.jsx("a",{href:"https://github.com/010101-sans/moctale-plus",target:"_blank",rel:"noopener noreferrer",className:"text-white/70 hover:text-[#DDD] transition-colors underline decoration-dotted",onClick:e=>e.stopPropagation(),children:"Moctale Plus"})]})]})]}),b=()=>{const o=Array.from(document.querySelectorAll("button")).filter(e=>"Save"===e.getAttribute("aria-label")||e.textContent&&"Save"===e.textContent.trim());0!==o.length&&o.forEach((o,n)=>{const r=o.parentElement;if(!r)return;if(r.querySelector(".moctale-plus-export-wrapper"))return;const l=document.createElement("div");l.className="moctale-plus-export-wrapper",l.style.display="inline-flex",l.style.alignItems="center",o.nextSibling?r.insertBefore(l,o.nextSibling):r.appendChild(l),t.createRoot(l).render(e.jsx(w,{})),console.log(`[Moctale+] Export Button Injected (Instance ${n+1})`)})},y=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),e.jsx("polyline",{points:"7 10 12 15 17 10"}),e.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),v=()=>e.jsxs("button",{type:"button",onClick:()=>{const e=(()=>{const e=[],t=document.querySelectorAll('div[role="link"]');if(0===t.length&&0===document.querySelectorAll(".grid > div.group").length)return alert("[Moctale+] No items found. Please wait for the collection to load."),[];return t.forEach(t=>{const o=t.querySelector("h3"),n=o?.textContent?.trim()||"Unknown Title",r=t.querySelector("p"),l=r?.textContent?.trim()||"";let a="Unknown",i="N/A";const s=l.match(/^(.*?)\s+â€¢\s+(\d{4})$/);if(s)a=s[1].trim(),i=s[2];else{const e=l.match(/\d{4}/);e&&(i=e[0]),l.toLowerCase().includes("movie")?a="Movie":l.toLowerCase().includes("show")&&(a="Show")}e.push({title:n,year:i,type:a})}),e})();if(e&&e.length>0){const t=document.querySelector("h1.text-xl.lg\\:text-2xl.font-bold");((e,t)=>{const o=[["Title","Year","Type"].join(","),...e.map(e=>`"${e.title.replace(/"/g,'""')}",${e.year},${e.type}`)].join("\n"),n=new Blob([o],{type:"text/csv;charset=utf-8;"}),r=URL.createObjectURL(n),l=document.createElement("a");l.href=r;const a=t.replace(/[<>:"/\\|?*\x00-\x1F]/g,"").trim();l.setAttribute("download",`${a}.csv`),document.body.appendChild(l),l.click(),document.body.removeChild(l)})(e,t?.textContent?.trim()||"My_Moctale_Collection")}},className:"\n        h-10 px-3 ml-2 rounded-md\n        inline-flex items-center justify-center gap-2\n        transition-colors duration-200\n        focus:outline-none focus:ring-1\n        bg-[#1A1A1A] hover:bg-[#252525] focus:ring-[#404040]\n        cursor-pointer \n      ",title:"Tip: Scroll to bottom of the collection first.",children:[e.jsx(y,{}),e.jsxs("div",{className:"flex flex-col items-start justify-center gap-1",children:[e.jsx("span",{className:"text-xs font-medium text-white leading-none",children:"Export Collection"}),e.jsxs("span",{className:"text-[9px] text-white/60 leading-none whitespace-nowrap",children:["Powered by"," ",e.jsx("a",{href:"https://github.com/010101-sans/moctale-plus",target:"_blank",rel:"noopener noreferrer",className:"text-white/70 hover:text-[#DDD] transition-colors underline decoration-dotted",onClick:e=>e.stopPropagation(),children:"Moctale Plus"})]})]})]}),j=()=>{if(document.getElementById("moctale-plus-my-export-btn"))return;const o=Array.from(document.querySelectorAll("button")).find(e=>e.textContent?.includes("Add Content"));if(o&&o.parentElement){const n=o.parentElement;n.style.display="flex",n.style.alignItems="center",n.style.gap="8px";const r=document.createElement("div");r.id="moctale-plus-my-export-btn",n.appendChild(r),t.createRoot(r).render(e.jsx(v,{})),console.log("[Moctale+] My Collection Export Button Injected")}},C=e=>{const t=setInterval(()=>{const o=document.querySelector('input[placeholder*="Search for Movies"]');o&&(clearInterval(t),k(o,e))},200);setTimeout(()=>clearInterval(t),3e3)},k=(e,t)=>{e.focus();const o=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value")?.set;o?o.call(e,t):e.value=t;const n=new Event("input",{bubbles:!0});e.dispatchEvent(n),setTimeout(()=>{const t=new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,key:"Enter",code:"Enter",keyCode:13,charCode:13});e.dispatchEvent(t)},300)},E=e=>{console.log(`[Moctale+] Shortcut: Navigating to ${e}`),window.location.href=e},S=()=>{const e=(()=>{const e=document.querySelector('header a[href^="/u/"]')||document.querySelector('a[href^="/u/"]');if(e){const t=e.getAttribute("href");return t?t.split("/u/")[1]:null}return null})(),t=window.location.pathname,o=e?`/u/${e}`:null,n="/my-collections",r="/saved-collections";console.log(`[Moctale+] Cycling Profile. Current: ${t}, User: ${e}`),o&&t.includes(o)?E(n):t.includes(n)?E(r):t.includes(r)&&o?E(o):E(o||n)},N=e=>{e&&(console.log("[Moctale+] Keyboard Shortcuts Initialized (Capture Mode)"),window.addEventListener("keydown",e=>{const t=e.target;if(!("INPUT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable||e.ctrlKey||e.altKey||e.metaKey||e.shiftKey))switch(e.key){case"1":e.preventDefault(),e.stopPropagation(),E("/explore");break;case"2":e.preventDefault(),e.stopPropagation(),(()=>{const e=window.location.href;e.includes("timeFilter=today")?E("/schedule?timeFilter=upcoming"):e.includes("timeFilter=upcoming")?E("/schedule?timeFilter=announced"):E("/schedule?timeFilter=today")})();break;case"3":e.preventDefault(),e.stopPropagation(),E("/clubs");break;case"4":e.preventDefault(),e.stopPropagation(),(()=>{const e=window.location.pathname;E("/explore/categories"===e?"/explore/genres":"/explore/genres"===e?"/explore/anime":"/explore/anime"===e?"/explore/franchise":"/explore/categories")})();break;case"5":e.preventDefault(),e.stopPropagation(),(()=>{console.log("[Moctale+] Shortcut: Triggering Search");const e=document.querySelector('button[aria-label="Search"]');e?e.click():window.location.hash="#auto_search="})();break;case"6":e.preventDefault(),e.stopPropagation(),S()}},{capture:!0}))},$=()=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M3 7h4c1.5 0 2.9.7 3.8 1.9l6.4 8.2"}),e.jsx("path",{d:"M3 17h4c1.5 0 2.9-.7 3.8-1.9l6.4-8.2"}),e.jsx("path",{d:"M17 7h4"}),e.jsx("path",{d:"M17 17h4"}),e.jsx("path",{d:"M21 7l-2.5-2.5"}),e.jsx("path",{d:"M21 17l-2.5 2.5"})]}),A=()=>e.jsxs("svg",{className:"animate-spin",xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),L=()=>e.jsxs("span",{className:"text-[9px] text-white/60 leading-none whitespace-nowrap",children:["Powered by"," ",e.jsx("a",{href:"https://github.com/010101-sans/moctale-plus",target:"_blank",rel:"noopener noreferrer",className:"text-white/70 hover:text-[#DDD] transition-colors underline decoration-dotted",onClick:e=>e.stopPropagation(),children:"Moctale Plus"})]}),M=()=>{const[t,n]=o.useState(!1),[r,l]=o.useState("Pick Random");return e.jsxs("button",{type:"button",onClick:()=>{if(t)return;n(!0),l("Picking...");let e=Array.from(document.querySelectorAll('a[href^="/content/"]'));if(0===e.length&&(e=Array.from(document.querySelectorAll('div[role="link"]'))),0===e.length)return alert("[Moctale+] No content found. Please scroll down."),n(!1),void l("Pick Random");const o=e[Math.floor(Math.random()*e.length)];setTimeout(()=>{let e=o.getAttribute("href");e||(e=(e=>{try{const t=e.querySelector("h3"),o=t?.textContent?.trim()||e.getAttribute("aria-label")||"",n=e.querySelector("p"),r=(n?.textContent?.trim()||"").match(/\d{4}/),l=r?r[0]:"";if(!o||!l)return null;const a=o.toLowerCase().replace(/&/g,"and").replace(/[':]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"");return`${window.location.origin}/content/${a}-${l}`}catch(t){return null}})(o)),e?(e.startsWith("/")&&(e=`${window.location.origin}${e}`),window.open(e,"_blank")?.focus()):o.click(),n(!1),l("Pick Random")},600)},disabled:t,className:`\n                h-10 px-3 ml-2 rounded-md\n                inline-flex items-center justify-center gap-2\n                transition-colors duration-200\n                focus:outline-none focus:ring-1\n                bg-[#1A1A1A] hover:bg-[#252525] focus:ring-[#404040]\n                cursor-pointer shadow-sm\n                ${t?"opacity-80 cursor-wait":""}\n            `,title:"Pick a random item & open in new tab",children:[t?e.jsx(A,{}):e.jsx($,{}),e.jsxs("div",{className:"flex flex-col items-start justify-center gap-1",children:[e.jsx("span",{className:"text-xs font-medium text-white leading-none",children:r}),e.jsx(L,{})]})]})},T=()=>{const o=Array.from(document.querySelectorAll("button")).filter(e=>"Save"===e.getAttribute("aria-label")||e.textContent&&"Save"===e.textContent.trim()),n=document.querySelector("div.absolute.bottom-4.right-4"),r=document.querySelector(".flex.items-center.gap-3.ml-auto");(o.length>0?o.map(e=>e.parentElement):[n,r].filter(Boolean)).forEach((o,n)=>{if(!o)return;if((e=>{if(!window.location.pathname.includes("/explore/collection/"))return;const t=e.parentElement;if(!t)return;if("true"===t.dataset.moctaleLayoutFixed)return;t.style.flexDirection="column-reverse",t.style.alignItems="flex-end",t.style.gap="16px";const o=t.firstElementChild;o&&(o.style.width="100%",o.style.alignSelf="flex-start"),t.dataset.moctaleLayoutFixed="true"})(o),o.querySelector(".moctale-plus-random-wrapper"))return;const r=document.createElement("div");r.className="moctale-plus-random-wrapper",r.style.display="inline-flex",r.style.alignItems="center",(o.querySelector(".moctale-plus-export-wrapper")||o.querySelector(".moctale-plus-tier-wrapper"))&&(r.style.marginLeft="4px"),o.appendChild(r),t.createRoot(r).render(e.jsx(e.Fragment,{children:e.jsx(M,{})}))})},q=["die","died","dies","death","killed","kill","murder","murdered","ending","climax","twist","reveal","spoiler","cameo","post-credit","dead","alive","survive","betray","traitor","plot hole","sacrifice","villain","killer","secret","final","deadly","hijacks","bollywood","force","poster","indian","reinvent","understand","hmm"],I=['div[class*="text-[16px]"] p','div[class*="text-[14px]"] p',".whitespace-pre-wrap",'[class*="text-[#C6C6C6]"][class*="text-sm"]','.relative [class*="text-[#C6C6C6]"]'];let P=[],B=null,R=null;const D=e=>{const t=e.nodeValue;if(!t||t.length<15)return;const o=(()=>{const e=P.map(e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"));return new RegExp(`\\b(${e.join("|")})\\b`,"gi")})();if(!o.test(t))return;const n=e.parentElement;if(!n)return;if((e=>{if(!e)return!1;const t=e.tagName;if(/^H[1-6]$/.test(t))return!0;const o=e.className;if("string"==typeof o){if(o.includes("font-bold")&&"A"===t)return!0;if(o.includes("text-xl")||o.includes("text-2xl"))return!0;if(o.includes("font-semibold")&&"A"===t)return!0}return!1})(n)||n.dataset.moctaleProcessed)return;n.dataset.moctaleProcessed="true";const r=document.createDocumentFragment();let l,a=0;for(o.lastIndex=0;null!==(l=o.exec(t));){const e=t.slice(a,l.index);e&&r.appendChild(document.createTextNode(e));const n=document.createElement("span");n.className="moctale-redacted-word",n.textContent=l[0],n.title="Click to reveal word",n.addEventListener("click",e=>{e.stopPropagation(),e.preventDefault(),n.classList.add("revealed"),n.title=""}),r.appendChild(n),a=o.lastIndex}const i=t.slice(a);if(i&&r.appendChild(document.createTextNode(i)),n.replaceChild(r,e),!n.classList.contains("moctale-spoiler-blur")){n.classList.add("moctale-spoiler-blur");const e=document.createElement("div");e.className="moctale-spoiler-badge",e.innerHTML='\n            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="moctale-spoiler-icon">\n                <path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z" />\n                <circle cx="12" cy="12" r="3" />\n            </svg>\n            <div class="moctale-spoiler-text-col">\n                <span class="moctale-spoiler-title">Reveal Spoiler</span>\n                <span class="moctale-spoiler-sub">Powered by Moctale Plus</span>\n            </div>\n        ',n.appendChild(e),n.addEventListener("click",t=>{t.target.classList.contains("moctale-redacted-word")||(t.preventDefault(),t.stopPropagation(),n.classList.remove("moctale-spoiler-blur"),e.remove())},{once:!0})}},F=()=>{if(0===P.length)return;const e=[];I.forEach(t=>{try{document.querySelectorAll(t).forEach(t=>e.push(t))}catch(o){}}),0!==e.length&&e.forEach(e=>{if(e.dataset.moctaleProcessed)return;const t=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null),o=[];for(;t.nextNode();)o.push(t.currentNode);o.forEach(D)})},_=()=>{try{const e=location.pathname;return"/explore"===e||e.startsWith("/explore/collection")||e.startsWith("/my-collections")||e.startsWith("/schedule")}catch{return!1}},W=()=>{try{return location.pathname.startsWith("/schedule")}catch{return!1}},U=e=>{document.querySelectorAll("div.grid").forEach(t=>{const o=t.className;(o.includes("lg:grid-cols-")||o.includes("xl:grid-cols-")||o.includes("sm:grid-cols-"))&&!o.includes("grid-cols-[280px")&&(t.setAttribute("data-moctale-content-grid","true"),e?t.setAttribute("data-moctale-list-view","true"):t.removeAttribute("data-moctale-list-view"))})},O=e=>{document.querySelectorAll("div.grid").forEach(t=>{const o=t.parentElement;if(!o)return;o.querySelector('[aria-label^="Date:"]')&&(t.setAttribute("data-moctale-content-grid","true"),t.setAttribute("data-moctale-schedule-grid","true"),e?t.setAttribute("data-moctale-list-view","true"):t.removeAttribute("data-moctale-list-view"))})},H=e=>{if(!_())return;if((()=>{if(document.getElementById("moctale-grid-css"))return;const e=document.createElement("style");e.id="moctale-grid-css",e.innerHTML='\n        @media (min-width: 1024px) {\n\n            /* ===============================\n               GENERIC GRID (NON-LIST)\n            =============================== */\n            [data-moctale-content-grid="true"]:not([data-moctale-list-view="true"]) {\n                grid-template-columns: repeat(var(--moctale-cols, 5), minmax(0, 1fr)) !important;\n            }\n\n            /* ===============================\n               STANDARD LIST VIEW (NON-SCHEDULE)\n            =============================== */\n            [data-moctale-content-grid="true"][data-moctale-list-view="true"] {\n                display: flex !important;\n                flex-direction: column !important;\n                gap: 8px !important;\n            }\n\n            [data-moctale-content-grid="true"][data-moctale-list-view="true"] > * > div {\n                display: flex !important;\n                flex-direction: row !important;\n                align-items: center !important;\n                gap: 16px !important;\n                padding: 8px 12px !important;\n                background-color: #171717 !important;\n                border: 1px solid rgba(255,255,255,0.08) !important;\n                border-radius: 12px !important;\n            }\n\n            [data-moctale-content-grid="true"][data-moctale-list-view="true"] div[class*="aspect-"] {\n                width: 133px !important;\n                min-width: 133px !important;\n                height: 200px !important;\n                position: relative !important;\n                overflow: hidden !important;\n            }\n\n            [data-moctale-content-grid="true"][data-moctale-list-view="true"] img {\n                position: absolute !important;\n                inset: 0 !important;\n                width: 100% !important;\n                height: 100% !important;\n                object-fit: cover !important;\n            }\n\n            /* ===============================\n               SCHEDULE LIST VIEW (ISOLATED)\n            =============================== */\n            [data-moctale-schedule-grid="true"][data-moctale-list-view="true"] {\n                display: flex !important;\n                flex-direction: column !important;\n                gap: 8px !important;\n            }\n\n            [data-moctale-schedule-grid="true"][data-moctale-list-view="true"] > * > a.group {\n                display: flex !important;\n                flex-direction: row !important;\n                align-items: center !important;\n                gap: 16px !important;\n                padding: 8px 12px !important;\n                background-color: #171717 !important;\n                border: 1px solid rgba(255,255,255,0.08) !important;\n                border-radius: 12px !important;\n            }\n\n            [data-moctale-schedule-grid="true"][data-moctale-list-view="true"] div[class*="aspect-"] {\n                width: 133px !important;\n                min-width: 133px !important;\n                height: 200px !important;\n                position: relative !important;\n                overflow: hidden !important;\n            }\n        }\n    ',document.head.appendChild(e)})(),!e||0===e)return document.documentElement.style.removeProperty("--moctale-cols"),void document.querySelectorAll("[data-moctale-content-grid]").forEach(e=>{e.removeAttribute("data-moctale-content-grid"),e.removeAttribute("data-moctale-list-view"),e.removeAttribute("data-moctale-schedule-grid")});const t=1===e;W()?O(t):(t||document.documentElement.style.setProperty("--moctale-cols",e.toString()),U(t))};if(window.self!==window.top)throw new Error("[Moctale+] Blocked execution in iframe");console.log("%c[Moctale+] Loaded","color: #bada55");let V=null,K=[];const z=o=>{const n=(()=>{try{let e=document.querySelector("h1.text-\\[20px\\], h1.lg\\:text-\\[28px\\]");e||(e=Array.from(document.querySelectorAll("h1")).find(e=>{const t=e.textContent?.trim()||"";return t.length>1&&!["Menu","Home","Search","Moctale"].includes(t)})||null);let t=e?.textContent?.trim()||"";if(t=t.replace(/\(\d{4}\)/,"").trim(),!t)return null;const o=document.querySelector("div.text-\\[14px\\].text-\\[\\#ABABAB\\]"),n=o?.textContent?.trim()||"";let r="",l="Unknown";if(n){const e=n.match(/\b(19|20)\d{2}\b/);e&&(r=e[0]),n.includes("Movie")?l="Movie":(n.includes("Show")||n.includes("TV")||n.includes("Series")||n.includes("Season"))&&(l="Show")}const a=new Set;document.querySelectorAll('a[href*="/genre/"]').forEach(e=>a.add(e.textContent?.trim().toLowerCase()||""));const i=document.querySelector('a[href*="/country/"]'),s=i?.textContent?.trim().toLowerCase()||"";n&&a.add(n.toLowerCase());const c=["anime","donghua","seinen","shonen","shojo","josei","isekai","mecha","slice of life","animation"];let d=!1;for(const u of a)if(c.some(e=>u.includes(e))){d=!0;break}return d||"japan"!==s||(a.has("animation")||a.has("animated"))&&(d=!0),{title:t,year:r,isAnime:d,type:l}}catch(e){return console.error("[Moctale+] Error scraping page info:",e),null}})();if(!n)return;let r=null;const l=document.querySelector(".flex.flex-col.lg\\:flex-row.lg\\:justify-between");if(l)r=l.querySelector('[class*="xl:w-[306px]"]');else{const e=document.querySelectorAll('[class*="xl:w-[306px]"]');e.length>0&&(r=e[0])}if(!r)return;let a=document.getElementById("moctale-plus-root");a||(a=document.createElement("div"),a.id="moctale-plus-root",a.className="w-full",r.appendChild(a),V=t.createRoot(a)),V&&V.render(e.jsx(p,{mediaInfo:n,settings:o}))},G=async()=>{const e=await(async()=>new Promise(e=>{const t={activeTheme:"default",enableLinkifier:!0,enableDiscussions:!0,enablePlatforms:!0,enableCreative:!0,enableCollectionExport:!0,enableBoxOffice:!0,enableShortcuts:!0,enableTierList:!0,enablePickRandom:!0,enableSpoilerShield:!1,spoilerKeywords:q.join(", "),enableScrollSaver:!0,gridColumns:0};"undefined"!=typeof chrome&&chrome.storage?chrome.storage.local.get(null,o=>{let n={...t,...o};o.settings&&"object"==typeof o.settings&&(console.log("[Moctale+] Found nested settings object, merging..."),n={...n,...o.settings}),e(n)}):e(t)}))();if(console.log("[Moctale+] Applying Configuration:",e),K.forEach(clearTimeout),K=[],document.body.classList.remove("theme-oled","theme-coffee","theme-midnight","theme-light"),e.activeTheme&&"default"!==e.activeTheme&&document.body.classList.add(`theme-${e.activeTheme}`),e.enableLinkifier?f():document.querySelectorAll(`a.${h}`).forEach(e=>{const t=document.createTextNode(e.textContent||"");e.parentNode?.replaceChild(t,e)}),(window.location.pathname.includes("/content/")||window.location.pathname.includes("/title/"))&&(z(e),K.push(setTimeout(()=>z(e),1e3)),K.push(setTimeout(()=>z(e),3e3))),e.enableCollectionExport?(window.location.pathname.includes("/explore/collection/")&&setTimeout(b,1e3),window.location.pathname.includes("/my-collections")&&setTimeout(j,1e3)):(document.querySelectorAll(".moctale-plus-export-wrapper").forEach(e=>e.remove()),document.getElementById("moctale-plus-export-btn")?.remove(),document.getElementById("moctale-plus-my-export-btn")?.remove()),e.enablePickRandom?setTimeout(T,1e3):document.querySelectorAll(".moctale-plus-random-wrapper").forEach(e=>e.remove()),(()=>{if(!window.location.hash.startsWith("#auto_search="))return;const e=window.location.hash.replace("#auto_search=",""),t=decodeURIComponent(e);history.replaceState(null,"",window.location.pathname+window.location.search);const o=setInterval(()=>{const e=document.querySelector('button[aria-label="Search"]');e&&(clearInterval(o),e.click(),C(t))},300);setTimeout(()=>clearInterval(o),3e3)})(),N(e.enableShortcuts),e.enableSpoilerShield){const t=e.spoilerKeywords?e.spoilerKeywords.split(","):q;P=t.map(e=>e.trim()).filter(e=>e.length>0),0===P.length&&(P=q),console.log(`[Moctale+] Spoiler Shield: ACTIVE (${P.length} keywords) ðŸ›¡ï¸`),F(),B&&B.disconnect(),B=new MutationObserver(e=>{e.some(e=>e.addedNodes.length>0)&&(R&&clearTimeout(R),R=setTimeout(F,800))}),B.observe(document.body,{childList:!0,subtree:!0})}else B&&B.disconnect(),B=null,document.querySelectorAll(".moctale-spoiler-blur").forEach(e=>e.classList.remove("moctale-spoiler-blur")),document.querySelectorAll(".moctale-spoiler-badge").forEach(e=>e.remove()),document.querySelectorAll(".moctale-redacted-word").forEach(e=>e.classList.add("revealed")),console.log("[Moctale+] Spoiler Shield: STOPPED");H(e.gridColumns),window.moctaleGridInitialized||((e=>{if(!_())return;H(e),new MutationObserver(t=>{if(!t.some(e=>e.addedNodes.length>0))return;const o=1===e;W()?O(o):U(o)}).observe(document.body,{childList:!0,subtree:!0})})(e.gridColumns),window.moctaleGridInitialized=!0)};const Y=function(e,t){let o;return function(...n){clearTimeout(o),o=setTimeout(()=>e(...n),t)}}(()=>G(),500);"undefined"!=typeof chrome&&chrome.storage&&chrome.storage.onChanged.addListener(e=>{Y()});let X=location.href;const Z=new MutationObserver(e=>{if(location.href!==X)return X=location.href,console.log("[Moctale+] URL Changed"),void setTimeout(G,1500);e.some(e=>e.addedNodes.length>0)&&Y()}),J=document.getElementById("root")||document.body;J&&Z.observe(J,{subtree:!0,childList:!0}),setTimeout(G,1e3);
