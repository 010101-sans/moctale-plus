import{j as t,c as C}from"./index-BdTgVImM.js";const a=o=>t.jsx("img",{src:`https://cdn.simpleicons.org/${o}/white`,alt:o,className:"w-8 h-8 object-contain opacity-70 group-hover:opacity-100 transition-opacity duration-300",loading:"lazy"}),$=({label:o,icon:e,subtext:r,url:n})=>t.jsxs("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:`
      group flex items-center gap-3 p-3 rounded-xl 
      bg-[#252833]/40 border border-transparent 
      hover:bg-white/10 hover:border-white/30
      transition-all duration-200
    `,children:[t.jsx("div",{className:"flex-shrink-0 flex items-center justify-center",children:e}),t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{className:"text-sm font-medium text-[#E2E2E2] group-hover:text-white transition-colors",children:o}),t.jsx("span",{className:"text-[10px] text-[#888] group-hover:text-[#CCC] transition-colors",children:r})]}),t.jsx("span",{className:"ml-auto text-[#666] opacity-0 -translate-x-2 group-hover:opacity-100 group-hover:translate-x-0 transition-all duration-300",children:t.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("line",{x1:"7",y1:"17",x2:"17",y2:"7"}),t.jsx("polyline",{points:"7 7 17 7 17 17"})]})})]}),g=()=>t.jsx("div",{className:"w-full pt-3 mt-1 text-center border-t border-[#252833]",children:t.jsxs("p",{className:"text-[11px] text-[#555]",children:["Powered by"," ",t.jsx("a",{href:"https://github.com/010101-sans/moctale-plus",target:"_blank",rel:"noreferrer",className:"hover:text-[#888] underline decoration-dotted",children:"Moctale Plus"})," ","by"," ",t.jsx("a",{href:"https://github.com/010101-sans",target:"_blank",rel:"noreferrer",className:"hover:text-[#888] underline decoration-dotted",children:"010101-sans"})]})}),S=({title:o,year:e,type:r,isAnime:n})=>{const s=encodeURIComponent(`${o} ${e}`),l=r==="movie"?"movie":"series",c=[{label:"YouTube Reviews",icon:a("youtube"),url:`https://www.youtube.com/results?search_query=${s.replace(`%20${e}`,"")}${n?"+anime":""}+${l}+review`},{label:"YouTube Podcasts",icon:a("youtube"),url:`https://www.youtube.com/results?search_query=${s.replace(`%20${e}`,"")}${n?"+anime":""}+podcast+discussion`},{label:"Hidden Details",icon:a("youtube"),url:`https://www.youtube.com/results?search_query=${s.replace(`%20${e}`,"")}${n?"+anime":""}+detailed+analysis+and+breakdown`},{label:"Twitter / X",icon:a("x"),url:`https://twitter.com/search?q=${s.replace(`%20${e}`,"")}${n?"+anime":""}+review+sand+discussion&f=top`},{label:"Reddit",icon:a("reddit"),url:`https://www.reddit.com/search/?q=${s.replace(`%20${e}`,"")}${n?"+anime":""}+reviews+and+discussion`}];return t.jsxs("div",{className:"flex flex-col items-start px-5 py-5 gap-4 w-full md:bg-[#1B1B1B] md:border md:border-[#252833] rounded-2xl",children:[t.jsx("h2",{className:"text-[20px] font-medium text-[#E2E2E2] w-full border-b border-[#252833] pb-3 tracking-[0.1px]",children:"Reviews & Discussions"}),t.jsx("div",{className:"flex flex-col w-full gap-2",children:c.map((i,u)=>t.jsx($,{...i,subtext:`Search ${o}`},u))}),t.jsx(g,{})]})},T=({title:o,year:e,isAnime:r})=>{const n=encodeURIComponent(`${o} ${e}`),s=[...r?[{label:"MyAnimeList",icon:a("myanimelist"),url:`https://myanimelist.net/search/all?q=${n.replace(`%20${e}`,"")}`},{label:"AniList",icon:a("anilist"),url:`https://anilist.co/search/anime?search=${n.replace(`%20${e}`,"")}`},{label:"Kitsu",icon:a("kitsu"),url:`https://kitsu.io/anime?text=${n.replace(`%20${e}`,"")}`}]:[],{label:"IMDb",icon:a("imdb"),url:`https://www.imdb.com/find/?q=${n.replace(`%20${e}`,"")}`},{label:"TMDB",icon:a("themoviedatabase"),url:`https://www.themoviedb.org/search?query=${n.replace(`%20${e}`,"")}`},{label:"Letterboxd",icon:a("letterboxd"),url:`https://letterboxd.com/search/${n.replace(`%20${e}`,"")}/`}];return t.jsxs("div",{className:"flex flex-col items-start px-5 py-5 gap-4 w-full md:bg-[#1B1B1B] md:border md:border-[#252833] rounded-2xl",children:[t.jsx("h2",{className:"text-[20px] font-medium text-[#E2E2E2] w-full border-b border-[#252833] pb-3 tracking-[0.1px]",children:"More Platforms"}),t.jsx("div",{className:"flex flex-col w-full gap-2",children:s.map((l,c)=>t.jsx($,{...l,subtext:`View on ${l.label}`},c))}),t.jsx(g,{})]})},L=({title:o,year:e,type:r,isAnime:n})=>{const s=encodeURIComponent(`${o} ${e}`),l=r==="movie"?"movie":"series",c=[{label:"Songs and OSTs",icon:a("youtube"),url:`https://www.youtube.com/results?search_query=${s.replace(`%20${e}`,"")}+${l}${n?"+anime":""}+songs+and+OSTs`},...n?[{label:"Anime Music Videos",icon:a("youtube"),url:`https://www.youtube.com/results?search_query=${s.replace(`%20${e}`,"")}+${l}+Anime+music+videos+`},{label:"Anime Video Essays",icon:a("youtube"),url:`https://www.youtube.com/results?search_query=${s.replace(`%20${e}`,"")}+${l}+anime+video+essays`}]:[],{label:"Fan Edits",icon:a("youtube"),url:`https://www.youtube.com/results?search_query=${s.replace(`%20${e}`,"")}+${l}${n?"+anime":""}+fan+edits`},{label:"Behind the Scenes",icon:a("youtube"),url:`https://www.youtube.com/results?search_query=${s}${n?"+anime":""}+${l}+making+and+behind+the+scenes`}];return t.jsxs("div",{className:"flex flex-col items-start px-5 py-5 gap-4 w-full md:bg-[#1B1B1B] md:border md:border-[#252833] rounded-2xl",children:[t.jsx("h2",{className:"text-[20px] font-medium text-[#E2E2E2] w-full border-b border-[#252833] pb-3 tracking-[0.1px]",children:"Creative Corner"}),t.jsx("div",{className:"flex flex-col w-full gap-2",children:c.map((i,u)=>t.jsx($,{...i,subtext:`Search ${o}`},u))}),t.jsx(g,{})]})},B=()=>t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-[#888] group-hover:text-white transition-colors",children:[t.jsx("circle",{cx:"11",cy:"11",r:"8"}),t.jsx("path",{d:"m21 21-4.3-4.3"})]}),x=({label:o,url:e,colorClass:r})=>t.jsxs("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:`
      flex items-center gap-3 px-3 py-2.5 rounded-xl
      bg-[#252833]/40 border border-[#333] 
      hover:bg-[#303440] hover:border-[#555] hover:text-white
      transition-all duration-200 group
      text-xs font-medium text-[#C6C6C6]
      h-full
      ${r||""}
    `,children:[t.jsx("div",{className:"flex-shrink-0 opacity-70 group-hover:opacity-100 transition-opacity",children:t.jsx(B,{})}),t.jsx("span",{className:"truncate line-clamp-2 break-words whitespace-normal leading-tight text-left",children:o})]}),q=({title:o})=>{const e=encodeURIComponent(o);return t.jsxs("div",{className:"flex flex-col items-start px-5 py-5 gap-4 w-full md:bg-[#1B1B1B] md:border md:border-[#252833] rounded-2xl transition-all hover:border-[#3a3f50]",children:[t.jsx("h2",{className:"text-[20px] font-medium text-[#E2E2E2] w-full border-b border-[#252833] pb-3 tracking-[0.1px] flex justify-between items-center",children:"Box Office"}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 w-full",children:[t.jsx(x,{label:"Google Box Office",url:`https://www.google.com/search?q=${e}+box+office+report`}),t.jsx(x,{label:"Box Office Mojo",url:`https://www.boxofficemojo.com/search/?q=${e}`,colorClass:"hover:border-yellow-500/40"}),t.jsx(x,{label:"Sacnilk Verdict",url:`https://www.google.com/search?q=${e}+box+office+collection+site:sacnilk.com`,colorClass:"hover:border-red-500/40"}),t.jsx(x,{label:"Bollywood Hungama",url:`https://www.google.com/search?q=${e}+box+office+site:bollywoodhungama.com`}),t.jsx(x,{label:"The Numbers",url:`https://www.the-numbers.com/search?search_term=${e}`}),t.jsx(x,{label:"Wikipedia Budget",url:`https://en.wikipedia.org/wiki/Special:Search?search=${e}+film+box+office`})]}),t.jsx(g,{})]})},M=()=>{try{let o=document.querySelector("h1.text-\\[20px\\], h1.lg\\:text-\\[28px\\]");o||(o=Array.from(document.querySelectorAll("h1")).find(h=>{const f=h.textContent?.trim()||"";return f.length>1&&!["Menu","Home","Search","Moctale"].includes(f)})||null);let e=o?.textContent?.trim()||"";if(e=e.replace(/\(\d{4}\)/,"").trim(),!e)return null;const n=document.querySelector("div.text-\\[14px\\].text-\\[\\#ABABAB\\]")?.textContent?.trim()||"";let s="",l="Unknown";if(n){const p=n.match(/\b(19|20)\d{2}\b/);p&&(s=p[0]),n.includes("Movie")?l="Movie":(n.includes("Show")||n.includes("TV")||n.includes("Series")||n.includes("Season"))&&(l="Show")}const c=new Set;document.querySelectorAll('a[href*="/genre/"]').forEach(p=>c.add(p.textContent?.trim().toLowerCase()||""));const u=document.querySelector('a[href*="/country/"]')?.textContent?.trim().toLowerCase()||"";n&&c.add(n.toLowerCase());const m=["anime","donghua","seinen","shonen","shojo","josei","isekai","mecha","slice of life","animation"];let d=!1;for(const p of c)if(m.some(h=>p.includes(h))){d=!0;break}return!d&&u==="japan"&&(c.has("animation")||c.has("animated"))&&(d=!0),{title:e,year:s,isAnime:d,type:l}}catch(o){return console.error("[Moctale+] Error scraping page info:",o),null}},A=({mediaInfo:o,settings:e})=>t.jsxs("div",{className:"flex flex-col gap-6 w-full mt-6 transition-all duration-300 ease-in-out",children:[e.enableBoxOffice&&o.type==="Movie"&&t.jsx(q,{title:o.title,year:o.year}),e.enableDiscussions&&t.jsx(S,{...o}),e.enablePlatforms&&t.jsx(T,{...o}),e.enableCreative&&t.jsx(L,{...o})]}),k="moctale-linkified",b=/\b(?:https?:\/\/)?(?:www\.)?(?:[a-zA-Z0-9-]+\.)+[a-zA-Z]{2,}(?:\/[^\s"'<>]*)?\b/g,R=o=>{const e=o.startsWith("http")?o:`https://${o}`;try{return new URL(e).href}catch{return null}},I=()=>{const o=document.body,e=document.createTreeWalker(o,NodeFilter.SHOW_TEXT,{acceptNode(s){const l=s.parentElement;if(!l||l.closest("a, button, input, textarea, code, pre")||!s.nodeValue?.trim())return NodeFilter.FILTER_REJECT;const c=s.nodeValue||"";return!c.includes(".")||c.length<4||!/(?:https?:\/\/|www\.|[\w-]+\.[\w]{2,})/.test(c)?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT}}),r=[];let n;for(;n=e.nextNode();)r.push(n);r.forEach(s=>{const l=s.nodeValue;if(b.lastIndex=0,!b.test(l))return;b.lastIndex=0;const c=document.createDocumentFragment();let i=0,u=!1;l.replace(b,(m,d)=>{u=!0,c.append(l.slice(i,d));const p=R(m);if(!p)c.append(m);else{const h=document.createElement("a");h.href=p,h.textContent=m,h.target="_blank",h.rel="noopener noreferrer",h.className=`${k} text-blue-400 hover:underline cursor-pointer z-10 relative`,h.addEventListener("click",f=>f.stopPropagation()),c.append(h)}return i=d+m.length,m}),u&&(c.append(l.slice(i)),s.parentNode?.replaceChild(c,s))})},_=()=>{document.querySelectorAll(`a.${k}`).forEach(e=>{const r=document.createTextNode(e.textContent||"");e.parentNode?.replaceChild(r,e)})},P=()=>t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),t.jsx("polyline",{points:"7 10 12 15 17 10"}),t.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),F=()=>{const o=[],e=document.querySelectorAll('a[href^="/content/"].group');return e.length===0?(alert("[Moctale+] No content items found. Please scroll down to ensure items are loaded."),[]):(e.forEach(r=>{let n=r.getAttribute("aria-label");n||(n=r.querySelector("h3")?.textContent?.trim()||"Unknown Title");const l=r.querySelector("p")?.textContent?.trim()||"";let c="Unknown",i="N/A";const u=/^(.*?)\s+•\s+(\d{4})$/,m=l.match(u);if(m)c=m[1].trim(),i=m[2];else{const d=l.match(/\d{4}/);d&&(i=d[0]),l.toLowerCase().includes("movie")?c="Movie":l.toLowerCase().includes("show")||l.toLowerCase().includes("tv")?c="TV Show":l.toLowerCase().includes("season")&&(c="Season")}o.push({title:n,year:i,type:c})}),o)},D=(o,e)=>{const r=[["Title","Year","Type"].join(","),...o.map(i=>`"${i.title.replace(/"/g,'""')}",${i.year},${i.type}`)].join(`
`),n=new Blob([r],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(n),l=document.createElement("a");l.href=s;const c=e.replace(/[<>:"/\\|?*\x00-\x1F]/g,"").trim();l.setAttribute("download",`${c}.csv`),document.body.appendChild(l),l.click(),document.body.removeChild(l)},U=()=>{const o=()=>{const e=F();if(e&&e.length>0){const n=document.querySelector("h1.text-lg.lg\\:text-2xl")?.textContent?.trim()||"Moctale_Collection";D(e,n)}};return t.jsxs("button",{type:"button",onClick:o,className:`
        h-10 px-3 ml-2 rounded-md
        inline-flex items-center justify-center gap-2
        transition-colors duration-200
        focus:outline-none focus:ring-1
        bg-[#1A1A1A] hover:bg-[#252525] focus:ring-[#404040]
        cursor-pointer 
      `,title:"Tip: Scroll to bottom of the collection first.",children:[t.jsx(P,{}),t.jsxs("div",{className:"flex flex-col items-start justify-center gap-1",children:[t.jsx("span",{className:"text-xs font-medium text-white leading-none",children:"Export Collection to CSV"}),t.jsxs("span",{className:"text-[9px] text-white/60 leading-none whitespace-nowrap",children:["Powered by"," ",t.jsx("a",{href:"https://github.com/010101-sans/moctale-plus",target:"_blank",rel:"noopener noreferrer",className:"text-white/70 hover:text-[#DDD] transition-colors underline decoration-dotted",onClick:e=>e.stopPropagation(),children:"Moctale Plus"})]})]})]})},O=()=>{const e=Array.from(document.querySelectorAll("button")).filter(r=>r.getAttribute("aria-label")==="Save"||r.textContent&&r.textContent.trim()==="Save");e.length!==0&&e.forEach((r,n)=>{const s=r.parentElement;if(!s||s.querySelector(".moctale-plus-export-wrapper"))return;const l=document.createElement("div");l.className="moctale-plus-export-wrapper",l.style.display="inline-flex",l.style.alignItems="center",r.nextSibling?s.insertBefore(l,r.nextSibling):s.appendChild(l),C.createRoot(l).render(t.jsx(U,{})),console.log(`[Moctale+] Export Button Injected (Instance ${n+1})`)})},V=()=>t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),t.jsx("polyline",{points:"7 10 12 15 17 10"}),t.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),W=()=>{const o=[],e=document.querySelectorAll('div[role="link"]');return e.length===0&&document.querySelectorAll(".grid > div.group").length===0?(alert("[Moctale+] No items found. Please wait for the collection to load."),[]):(e.forEach(r=>{const s=r.querySelector("h3")?.textContent?.trim()||"Unknown Title",c=r.querySelector("p")?.textContent?.trim()||"";let i="Unknown",u="N/A";const m=/^(.*?)\s+•\s+(\d{4})$/,d=c.match(m);if(d)i=d[1].trim(),u=d[2];else{const p=c.match(/\d{4}/);p&&(u=p[0]),c.toLowerCase().includes("movie")?i="Movie":c.toLowerCase().includes("show")&&(i="Show")}o.push({title:s,year:u,type:i})}),o)},H=(o,e)=>{const r=[["Title","Year","Type"].join(","),...o.map(i=>`"${i.title.replace(/"/g,'""')}",${i.year},${i.type}`)].join(`
`),n=new Blob([r],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(n),l=document.createElement("a");l.href=s;const c=e.replace(/[<>:"/\\|?*\x00-\x1F]/g,"").trim();l.setAttribute("download",`${c}.csv`),document.body.appendChild(l),l.click(),document.body.removeChild(l)},z=()=>{const o=()=>{const e=W();if(e&&e.length>0){const n=document.querySelector("h1.text-xl.lg\\:text-2xl.font-bold")?.textContent?.trim()||"My_Moctale_Collection";H(e,n)}};return t.jsxs("button",{type:"button",onClick:o,className:`
        h-10 px-3 ml-2 rounded-md
        inline-flex items-center justify-center gap-2
        transition-colors duration-200
        focus:outline-none focus:ring-1
        bg-[#1A1A1A] hover:bg-[#252525] focus:ring-[#404040]
        cursor-pointer 
      `,title:"Tip: Scroll to bottom of the collection first.",children:[t.jsx(V,{}),t.jsxs("div",{className:"flex flex-col items-start justify-center gap-1",children:[t.jsx("span",{className:"text-xs font-medium text-white leading-none",children:"Export Collection to CSV"}),t.jsxs("span",{className:"text-[9px] text-white/60 leading-none whitespace-nowrap",children:["Powered by"," ",t.jsx("a",{href:"https://github.com/010101-sans/moctale-plus",target:"_blank",rel:"noopener noreferrer",className:"text-white/70 hover:text-[#DDD] transition-colors underline decoration-dotted",onClick:e=>e.stopPropagation(),children:"Moctale Plus"})]})]})]})},K=()=>{if(document.getElementById("moctale-plus-my-export-btn"))return;const e=Array.from(document.querySelectorAll("button")).find(r=>r.textContent?.includes("Add Content"));if(e&&e.parentElement){const r=e.parentElement;r.style.display="flex",r.style.alignItems="center",r.style.gap="8px";const n=document.createElement("div");n.id="moctale-plus-my-export-btn",r.appendChild(n),C.createRoot(n).render(t.jsx(z,{})),console.log("[Moctale+] My Collection Export Button Injected")}};console.log("%c[Moctale+] Loaded","color: #bada55");let v=null,w=[];const Y=async()=>new Promise(o=>{const e={activeTheme:"default",enableLinkifier:!0,enableDiscussions:!0,enablePlatforms:!0,enableCreative:!0,enableCollectionExport:!0,enableBoxOffice:!0};typeof chrome<"u"&&chrome.storage?chrome.storage.local.get(e,r=>o(r)):o(e)}),j=o=>{const e=M();if(!e)return;let r=null;const n=document.querySelector(".flex.flex-col.lg\\:flex-row.lg\\:justify-between");if(n)r=n.querySelector('[class*="xl:w-[306px]"]');else{const l=document.querySelectorAll('[class*="xl:w-[306px]"]');l.length>0&&(r=l[0])}if(!r)return;let s=document.getElementById("moctale-plus-root");s||(s=document.createElement("div"),s.id="moctale-plus-root",s.className="w-full",r.appendChild(s),v=C.createRoot(s)),v&&v.render(t.jsx(A,{mediaInfo:e,settings:o}))},y=async()=>{const o=await Y();w.forEach(clearTimeout),w=[],document.body.classList.remove("theme-oled","theme-coffee","theme-midnight"),o.activeTheme&&o.activeTheme!=="default"&&document.body.classList.add(`theme-${o.activeTheme}`),o.enableLinkifier?I():_(),(window.location.pathname.includes("/content/")||window.location.pathname.includes("/title/"))&&(j(o),w.push(setTimeout(()=>j(o),1e3)),w.push(setTimeout(()=>j(o),3e3))),o.enableCollectionExport?(window.location.pathname.includes("/explore/collection/")&&setTimeout(O,1e3),window.location.pathname.includes("/my-collections")&&setTimeout(K,1e3)):(document.querySelectorAll(".moctale-plus-export-wrapper").forEach(e=>e.remove()),document.getElementById("moctale-plus-export-btn")?.remove(),document.getElementById("moctale-plus-my-export-btn")?.remove())};function G(o,e){let r;return function(...n){clearTimeout(r),r=setTimeout(()=>o(...n),e)}}const X=G(()=>y(),500);typeof chrome<"u"&&chrome.storage&&chrome.storage.onChanged.addListener(o=>{y()});let E=location.href;const J=new MutationObserver(o=>{if(location.href!==E){E=location.href,setTimeout(y,1500);return}o.some(e=>e.addedNodes.length>0)&&X()}),N=document.getElementById("root")||document.body;N&&J.observe(N,{subtree:!0,childList:!0});setTimeout(y,1e3);
